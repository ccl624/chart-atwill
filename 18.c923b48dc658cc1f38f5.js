(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{yBh3:function(t,a,e){"use strict";e.r(a);var r=e("CcnG"),n=function(){function t(t){this.http=t}return t.prototype.getChinaJSON=function(t){return void 0===t&&(t={params:{}}),t.showLoading=!1,this.http.get("assets/json/china.json",t)},t.prototype.getChinaMapOutlineJSON=function(t){return void 0===t&&(t={params:{}}),t.showLoading=!1,this.http.get("assets/json/china_outline.json",t)},t}(),i=e("VphZ"),o=function(){function t(t){this.chinaMapService=t,this.svgH=0,this.svgW=0,this.barSize={w:10,h:5,x:5},this.showData=[{name:"\u65b0\u7586",value:993},{name:"\u897f\u85cf",value:667},{name:"\u5317\u4eac",value:667},{name:"\u5929\u6d25",value:667},{name:"\u6cb3\u5357",value:667},{name:"\u5b89\u5fbd",value:667},{name:"\u56db\u5ddd",value:667},{name:"\u9655\u897f",value:667}],this.barColor={normal:{type:"linear",x1:0,x2:0,y1:0,y2:1,colorStops:[{offset:0,color:"#aedcff",opacity:.9},{offset:.25,color:"#aedcff",opacity:.86},{offset:.5,color:"#aedcff",opacity:.66},{offset:.85,color:"#aedcff",opacity:.1},{offset:1,color:"#aedcff",opacity:0}]},active:{type:"linear",x1:0,x2:0,y1:0,y2:1,colorStops:[{offset:0,color:"#f0302e",opacity:.9},{offset:.25,color:"#f0302e",opacity:.86},{offset:.5,color:"#f0302e",opacity:.66},{offset:.85,color:"#f0302e",opacity:.1},{offset:1,color:"#f0302e",opacity:0}]}},this.barColorRight={normal:{type:"linear",x1:0,x2:0,y1:0,y2:1,colorStops:[{offset:0,color:"#aedcff",opacity:.7},{offset:.25,color:"#aedcff",opacity:.66},{offset:.5,color:"#aedcff",opacity:.46},{offset:.85,color:"#aedcff",opacity:.1},{offset:1,color:"#aedcff",opacity:0}]},active:{type:"linear",x1:0,x2:0,y1:0,y2:1,colorStops:[{offset:0,color:"#f0302e",opacity:.7},{offset:.25,color:"#f0302e",opacity:.66},{offset:.5,color:"#f0302e",opacity:.46},{offset:.85,color:"#f0302e",opacity:.1},{offset:1,color:"#f0302e",opacity:0}]}},this.markColor={normal:{type:"linear",x1:0,x2:1,y1:0,y2:0,colorStops:[{offset:0,color:"#cec396",opacity:0},{offset:.3,color:"#cec396",opacity:.4},{offset:.7,color:"#cec396",opacity:.4},{offset:1,color:"#cec396",opacity:0}]},active:{type:"linear",x1:0,x2:1,y1:0,y2:0,colorStops:[{offset:0,color:"#f0302e",opacity:0},{offset:.3,color:"#f0302e",opacity:.4},{offset:.7,color:"#f0302e",opacity:.4},{offset:1,color:"#f0302e",opacity:0}]}},this.scale=880,this.isLodadingMapDtaCompleted=!1,this.barDegree=.001,this.showMarker=!0,this.preDuration=100}return Object.defineProperty(t.prototype,"data",{get:function(){return this.showData},set:function(t){this.showData=t,this.isLodadingMapDtaCompleted&&this.updateMapData()},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.transition=i.C().duration(1e3),this.barSize.w=this.scale*this.barDegree*10,this.barSize.h=this.scale*this.barDegree*5,this.barSize.x=this.scale*this.barDegree*5},t.prototype.ngAfterViewInit=function(){this.initSvg(),this.createGradient(),this.createFilter("china_map_filter"),this.getChinaMapData()},t.prototype.initSvg=function(){var t=i.y("#d3-geo");this.svgW=Number.parseFloat(t.style("width")),this.svgH=Number.parseFloat(t.style("height")),this.svg=i.y("#d3-geo").append("svg").attr("width",this.svgW).attr("height",this.svgH),this.defs=this.svg.append("defs")},t.prototype.startAnimate=function(){this.showData=[{name:"\u65b0\u7586",value:993*Math.random()},{name:"\u897f\u85cf",value:667*Math.random()},{name:"\u5317\u4eac",value:667*Math.random()},{name:"\u5929\u6d25",value:667*Math.random()},{name:"\u6cb3\u5357",value:667*Math.random()}],this.updateMapData()},t.prototype.getChinaMapData=function(){var t=this;Promise.all([this.getChinaJSON(),this.getChinaMapOutLine()]).then(function(a){var e=t.initProjection(a[0].cp);t.drawChinaOutLineMap(a[1].features,e);var r=t.initGNodes(a[0].features,"china-map");t.drawChinaMap(r,e),t.drawMapData(r,e),t.isLodadingMapDtaCompleted=!0})},t.prototype.initProjection=function(t){return void 0===t&&(t=[0,0]),i.l().center(t).scale(this.scale).translate([this.svgW/2,this.svgH/2])},t.prototype.initGNodes=function(t,a){var e=this,r=t.map(function(t){var a=e.showData.find(function(a){return a.name===t.properties.name}),r=Math.max.apply(null,e.showData.map(function(t){return t.value}));return Object.assign(t,{value:a?a.value:0,height:a?a.value/r*100:0})}).sort(function(t){return t.height?-1:1});return this.svg.selectAll(a).data(r).enter().append("g").attr("class",a)},t.prototype.drawChinaOutLineMap=function(t,a){var e=this.svg.selectAll(".china-map-outline").data(t).enter().append("g").attr("class","china-map-outline");e.append("path").attr("transform","translate(0,15)").attr("class","outline-filter").attr("d",i.m(a)).attr("fill","none").attr("stroke","#9fc8e7").attr("filter","url(#china_map_filter)").attr("stroke-width","1"),e.append("path").attr("class","outline").attr("d",i.m(a)).attr("fill","none").attr("stroke","#9fc8e7").attr("stroke-width",2).call(this.nodeAction.bind(this))},t.prototype.drawChinaMap=function(t,a){t.append("g").attr("class","mapG").append("path").attr("class","batman-path").attr("d",i.m(a)).attr("fill","none").attr("stroke","#e7d9a41a").attr("stroke-width","2")},t.prototype.drawMapData=function(t,a){this.dataShapeG=t.append("g").attr("class","data-shape-g").attr("id",function(t,a){return"data-shape-g"+a}).attr("transform",function(t){return"translate("+a(t.properties.cp)+")"}).call(this.nodeAction.bind(this)),this.drawCpName(this.dataShapeG),this.drawMapBar(this.dataShapeG),this.drawMapMarker(this.dataShapeG)},t.prototype.drawCpName=function(t){var a=t.append("g").attr("class","cp-name data-shape-child");a.append("text").text(function(t){return t.properties.name}).attr("transform","translate(-8,0) scale(0.8)").attr("text-anchor","end").attr("dominant-baseline","middle").style("fill","#e7d9a466"),a.append("circle").attr("class","cp-icon").attr("r",3).attr("x",0).attr("y",0).attr("fill","#e3d49d")},t.prototype.drawMapBar=function(t){var a=this,e=this.barSize.h,r=this.barSize.x,n=this.barSize.w;this.barG=t.append("g").attr("class","barG data-shape-child").attr("transform","translate("+(-r-1.5)+",0)").attr("cursor","pointer").style("display",function(t){return t.height?"block":"none"}),this.barG.append("path").attr("class","rightSauare").attr("fill","url(#china_bar_right)").attr("stroke-width",1).attr("stroke","rgba(0,0,0,0)").attr("d",function(t){return"M"+n+",0 L"+n+","+-0+" L"+(r+n)+","+(-0-e)+" L"+(r+n)+","+-e+" L"+n+",0 Z "}).transition(this.transition).delay(function(t,e){return t.height?e*a.preDuration:0}).attr("d",function(t){var a=t.height;return"M"+n+",0 L"+n+","+-a+" L"+(r+n)+","+(-a-e)+" L"+(r+n)+","+-e+" L"+n+",0 Z "}),this.barG.append("path").attr("class","frontSauare").attr("fill","url(#china_bar_front)").attr("stroke-width",1).attr("stroke","rgba(0,0,0,0)").attr("d",function(t){return"M0,0 L0,0 L"+n+","+-0+" L"+n+",0 Z"}).transition(this.transition).delay(function(t,e){return t.height?e*a.preDuration:0}).attr("d",function(t){var a=t.height;return"M0,0 L0,"+-a+" L"+n+","+-a+" L"+n+",0 Z"}),this.barG.append("path").attr("class","topSauare").attr("fill","#aedcffb3").attr("stroke-width",0).attr("stroke","rgba(0,0,0,0)").attr("d",function(t){return"M0,0 L"+n+","+-0+" L"+(r+n)+","+(-0-e)+" L"+r+","+(-0-e)+" Z"}).transition(this.transition).delay(function(t,e){return t.height?e*a.preDuration:0}).attr("d",function(t){var a=t.height;return"M0,"+-a+" L"+n+","+-a+" L"+(r+n)+","+(-a-e)+" L"+r+","+(-a-e)+" Z"})},t.prototype.drawMapMarker=function(t){var a=this;if(!this.showMarker)return!1;this.markerG=t.append("g").attr("class","markG data-shape-child").attr("cursor","pointer").attr("transform","translate(-3,-64) scale(0.8, 1)").style("display","none"),this.markerG.append("rect").attr("class","text-wrap").attr("x",function(t){return-a.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2))/2}).attr("width",function(t){return t.value?a.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2)):0}).attr("height",36).attr("fill","url(#china_marker_color)").attr("y",-19).attr("transform","translate(5,0)"),this.markerG.append("text").attr("class","marker-text-name").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("fill","#cec396").attr("transform","translate(5,-9)").text(function(t){return t.properties.name}),this.markerG.append("text").attr("class","marker-text-num").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("fill","#cec396").attr("transform","translate(5,9)").transition(this.transition).delay(function(t,e){return t.height?e*a.preDuration:0}).textTween(function(t){return function(a){return a*t.value?"\u8bbf\u95ee\u91cf\uff1a"+(a*t.value).toFixed(2):""}}),this.markerG.append("path").attr("class","arrow-icon").attr("d",function(t){return"M0,21 L4,21 L0,29, L-4,21 Z"}).attr("fill",function(t){return t.height?"#aedcff":"none"}).attr("transform","translate(5,0)"),this.drawMarkFrame(this.markerG,36),this.markerG.transition(this.transition).delay(function(t,e){return t.height?e*a.preDuration:0}).attr("transform",function(t){return"translate(-3,"+(-t.height-40)+") scale(0.8, 1)"}).on("end",function(t,e){if(e===a.showData.length-1)var r=setTimeout(function(){a.startAnimate(),clearTimeout(r)},1e3)})},t.prototype.drawMarkFrame=function(t,a){var e=this,r=t.append("g").attr("class","frame-g"),n=a/2;r.append("path").attr("class","marker-frame marker-frame-left-top").attr("d",function(t){var a=-e.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2))/2,r=-n;return"M"+(a+6)+","+r+" L"+a+","+r}).attr("stroke","#aedcff").attr("stroke-width",function(t){return t.height?2:0}),r.append("path").attr("class","marker-frame marker-frame-right-top").attr("d",function(t){var a=e.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2))/2+6,r=-n;return"M"+a+","+r+" L"+(a+6)+","+r}).attr("stroke","#aedcff").attr("stroke-width",function(t){return t.height?2:0}),r.append("path").attr("class","marker-frame marker-frame-left-bottom").attr("d",function(t){var a=-e.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2))/2,r=n-1;return"M"+(a+6)+","+r+" L"+a+","+r}).attr("stroke","#aedcff").attr("stroke-width",function(t){return t.height?2:0}),r.append("path").attr("class","marker-frame marker-frame-right-bottom").attr("d",function(t){var a=e.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2))/2+6,r=n-1;return"M"+a+","+r+" L"+(a+6)+","+r}).attr("stroke","#aedcff").attr("stroke-width",function(t){return t.height?2:0})},t.prototype.updateMapData=function(){var t=this;this.dataShapeG.each(function(a,e){var r=t.showData.find(function(t){return t.name===a.properties.name}),n=Math.max.apply(null,t.showData.map(function(t){return t.value}));a=Object.assign(a,{value:r?r.value:0,height:r?r.value/n*100:0})}),this.updateMapBar(this.barG),this.updateMarker(this.markerG)},t.prototype.updateMapBar=function(t){var a=this.barSize.h,e=this.barSize.x,r=this.barSize.w;t.style("display",function(t){return t.height?"block":"none"}).selectAll(".rightSauare").transition(this.transition).attr("d",function(t){var n=t.height;return"M"+r+",0 L"+r+","+-n+" L"+(e+r)+","+(-n-a)+" L"+(e+r)+","+-a+" L"+r+",0 Z "}),t.selectAll(".frontSauare").transition(this.transition).attr("d",function(t){var a=t.height;return"M0,0 L0,"+-a+" L"+r+","+-a+" L"+r+",0 Z"}),t.selectAll(".topSauare").transition(this.transition).attr("d",function(t){var n=t.height;return"M0,"+-n+" L"+r+","+-n+" L"+(e+r)+","+(-n-a)+" L"+e+","+(-n-a)+" Z"})},t.prototype.updateMarker=function(t){var a=this;t.selectAll(".text-wrap").attr("x",function(t){return-a.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2))/2}).transition(this.transition).attr("width",function(t){return t.value?a.getTextWidth("\u8bbf\u95ee\u91cf\uff1a"+t.value.toFixed(2)):0}),t.selectAll(".marker-text-num").transition(this.transition).textTween(function(t){return function(a){return a*t.value?"\u8bbf\u95ee\u91cf\uff1a"+(a*t.value).toFixed(2):""}}),t.selectAll(".marker-frame").attr("stroke-width",function(t){return t.value?2:0}),t.transition(this.transition).attr("transform",function(t){return"translate(-3,"+(-t.height-40)+") scale(0.8, 1)"}).on("end",function(t,e){if(e===a.showData.length-1)var r=setTimeout(function(){a.startAnimate(),clearTimeout(r)},1e3)})},t.prototype.activeBar=function(t,a){void 0===a&&(a=!0),t.selectAll(".rightSauare").attr("fill",a?"url(#china_bar_right_active)":"url(#china_bar_right)"),t.selectAll(".frontSauare").attr("fill",a?"url(#china_bar_front_active)":"url(#china_bar_front)"),t.selectAll(".topSauare").attr("fill",a?"#f0302eb3":"#aedcffb3")},t.prototype.activeMarker=function(t,a){void 0===a&&(a=!0),t.select(".markG").selectAll(".text-wrap").attr("fill",a?"url(#china_marker_color_active)":"url(#china_marker_color)"),t.select(".markG").selectAll(".arrow-icon").attr("fill",a?"#f0302e":"#aedcff"),t.select(".markG").selectAll(".marker-frame").attr("stroke",a?"#f0302e":"#aedcff")},t.prototype.activeCpIcon=function(t,a){void 0===a&&(a=!0),t.select(".cp-icon").attr("fill",a?"#f0302e":"#cec396")},t.prototype.activeNodes=function(t,a){this.activeBar(t,a),this.activeMarker(t,a),this.activeCpIcon(t,a)},t.prototype.mapMouseEvent=function(t){var a=this;t.on("mouseout",function(){i.y(this).select(".markG").style("display","none"),a.activeNodes(i.y(this),!1)}).on("mouseover",function(t,e){a.activeNodes(i.y(this),!0),a.svg.selectAll(".china-map").sort(function(a,e){return a.properties.name===t.properties.name?1:-1}),i.y(this).select(".markG").style("display",t.height?"block":"none")})},t.prototype.blingAnimate=function(t,a,e){var r=this;t.transition().duration(600).attr(a.name,e).on("end",function(){r.blingAnimate(t,a,e===a.values[0]?a.values[1]:a.values[0])})},t.prototype.nodeAction=function(t){switch(t.attr("class")){case"data-shape-g":this.mapMouseEvent(t);break;case"outline":this.blingAnimate(t,{name:"stroke-width",values:["0","2"]},"0");break;default:console.log("\u6240\u9009\u5143\u7d20\u4e0d\u5b58\u5728\uff0c\u8bf7\u67e5\u770bclass\u5c5e\u6027\u662f\u5426\u6487\u76ae\uff01")}},t.prototype.createGradient=function(){this.createLinearGradient("china_bar_front",this.barColor.normal),this.createLinearGradient("china_bar_right",this.barColorRight.normal),this.createLinearGradient("china_marker_color",this.markColor.normal),this.createLinearGradient("china_bar_front_active",this.barColor.active),this.createLinearGradient("china_bar_right_active",this.barColorRight.active),this.createLinearGradient("china_marker_color_active",this.markColor.active)},t.prototype.createLinearGradient=function(t,a){var e=this.defs.append("linearGradient").attr("id",t).attr("x1",a.x1).attr("y1",a.y1).attr("x2",a.x2).attr("y2",a.y2);a.colorStops.forEach(function(t){e.append("stop").attr("offset",t.offset).attr("stop-opacity",t.opacity).style("stop-color",a.colorStops[0].color)})},t.prototype.createFilter=function(t){this.defs.append("filter").attr("id",t).append("feGaussianBlur").attr("result","blurOut").attr("in","offOut").attr("stdDeviation",1)},t.prototype.getTextWidth=function(t){var a=i.y("body").append("span").style("display","inline-block").text(t),e=Number.parseInt(a.style("width"),10)+10;return a.remove(),e},t.prototype.getChinaMapOutLine=function(){var t=this;return new Promise(function(a){return t.chinaMapService.getChinaMapOutlineJSON().subscribe(function(t){return a(t)})})},t.prototype.getChinaJSON=function(){var t=this;return new Promise(function(a){return t.chinaMapService.getChinaJSON().subscribe(function(t){return a(t)})})},t}(),s=function(){return function(){}}(),l=e("pMnS"),c=r.pb({encapsulation:0,styles:[[".china-map-wrap[_ngcontent-%COMP%]{width:100%;height:100%;background-image:url(bg.3ce9daf8446f91a033b4.png);overflow:hidden}#d3-geo[_ngcontent-%COMP%]{width:100%;height:100%;-webkit-transform:rotateX(45deg);transform:rotateX(45deg)}"]],data:{}});function h(t){return r.Jb(0,[(t()(),r.rb(0,0,null,null,1,"div",[["class","china-map-wrap"]],null,null,null,null,null)),(t()(),r.rb(1,0,null,null,0,"div",[["id","d3-geo"]],null,null,null,null,null))],null,null)}function u(t){return r.Jb(0,[(t()(),r.rb(0,0,null,null,1,"china-map",[],null,null,null,h,c)),r.qb(1,4308992,null,0,o,[n],null,null)],function(t,a){t(a,1,0)},null)}var p=r.nb("china-map",o,u,{barColor:"barColor",barColorRight:"barColorRight",markColor:"markColor",scale:"scale",data:"data"},{},[]),f=e("Ip0R"),d=e("t/Na"),m=e("ZYCi");e.d(a,"ChinaMapModuleNgFactory",function(){return g});var g=r.ob(s,[],function(t){return r.Ab([r.Bb(512,r.j,r.Z,[[8,[l.a,p]],[3,r.j],r.x]),r.Bb(4608,f.l,f.k,[r.u,[2,f.w]]),r.Bb(4608,n,n,[d.c]),r.Bb(1073742336,f.b,f.b,[]),r.Bb(1073742336,m.m,m.m,[[2,m.r],[2,m.k]]),r.Bb(1073742336,s,s,[]),r.Bb(1024,m.i,function(){return[[{path:"",component:o}]]},[])])})}}]);